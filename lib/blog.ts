import type { BlogPost } from "./blog-utils"

// In-memory blog posts data
const blogPostsData: BlogPost[] = [
  {
    slug: "california-to-texas-registration",
    title: "Complete Guide: Moving Your Vehicle from California to Texas",
    date: "2024-01-15",
    readTime: "8 min",
    category: "State Guides",
    summary:
      "Everything you need to know about registering your California vehicle in Texas, including timelines, required documents, and cost breakdowns.",
    author: "Naz Diam",
    featured: true,
    tags: ["California", "Texas", "Interstate Move", "Registration"],
    content: `
Moving from California to Texas? You'll need to register your vehicle in Texas within 30 days of establishing residency. Here's your complete step-by-step guide.

## Timeline Requirements

Texas law requires you to register your vehicle within **30 days** of establishing residency. Missing this deadline can result in fines and penalties.

## Required Documents

### From California (Exit State)
- Current California vehicle registration
- California title (must be in your name)
- Smog certificate (if applicable)

### For Texas (Entry State)
- Proof of Texas residency (utility bill, lease agreement, or mortgage statement)
- Valid driver's license or ID
- Proof of insurance meeting Texas minimum requirements
- Vehicle Inspection Report (must be completed within 90 days)

## Step-by-Step Process

### Step 1: Get Texas Auto Insurance
Before you can register your vehicle, you need Texas auto insurance that meets state minimums:
- $30,000 bodily injury per person
- $60,000 bodily injury per accident
- $25,000 property damage

### Step 2: Complete Vehicle Inspection
Take your vehicle to a Texas-approved inspection station. The inspection costs around $7-$25 and checks:
- Emissions (in certain counties)
- Safety equipment
- VIN verification

### Step 3: Visit the County Tax Office
Bring all your documents to your local county tax assessor-collector's office. You'll need to:
- Complete Form 130-U (Application for Texas Title)
- Pay the title fee ($33)
- Pay registration fees (varies by vehicle weight and county)
- Pay the $90 new resident tax

### Step 4: Surrender California Plates
Texas requires you to surrender your California license plates. You can:
- Mail them to California DMV
- Drop them off at a California DMV office
- Keep them as souvenirs (after notifying California DMV)

## Cost Breakdown

| Item | Cost |
|------|------|
| Vehicle Inspection | $7-$25 |
| Title Fee | $33 |
| Registration Fee | $50.75+ |
| New Resident Tax | $90 |
| **Total Estimate** | **$180-$200** |

## Important Tips

**Tip 1:** Get your vehicle inspection done first. You can't complete registration without it.

**Tip 2:** If you have a loan on your vehicle, contact your lender to ensure the title is sent to the Texas DMV.

**Tip 3:** Keep copies of all documents for your records.

## Common Mistakes to Avoid

1. **Waiting too long** - The 30-day deadline is strict
2. **Wrong insurance** - Make sure your policy meets Texas requirements
3. **Missing inspection** - This is required before registration
4. **Incorrect address** - Use your actual Texas residence address

## What Happens After Registration?

Once registered, you'll receive:
- Texas license plates
- Registration sticker
- Texas title (mailed within 4-6 weeks)

Your registration will be valid for one year and must be renewed annually.

## Need Help?

Use our interactive checklist tool to get a personalized step-by-step guide for your specific situation, including all required forms and deadlines.
    `,
  },
  {
    slug: "understanding-vehicle-title-transfers",
    title: "Understanding Vehicle Title Transfers: A Complete Guide",
    date: "2024-01-10",
    readTime: "6 min",
    category: "Title Transfers",
    summary:
      "Learn everything about vehicle title transfers, including when they're required, how to complete them, and common pitfalls to avoid.",
    author: "Naz Diam",
    featured: true,
    tags: ["Title Transfer", "DMV", "Vehicle Ownership"],
    content: `
A vehicle title transfer is the legal process of changing ownership of a vehicle from one person to another. Whether you're buying, selling, gifting, or inheriting a vehicle, understanding title transfers is crucial.

## When Is a Title Transfer Required?

You need to transfer a vehicle title when:
- Buying or selling a vehicle
- Gifting a vehicle to a family member
- Inheriting a vehicle
- Moving to a new state (in some cases)
- Adding or removing a co-owner

## The Title Transfer Process

### Step 1: Seller's Responsibilities
The seller must:
- Sign the title in the designated area
- Provide the odometer reading (if vehicle is less than 10 years old)
- Complete a bill of sale
- Remove license plates (in most states)
- Cancel insurance after sale

### Step 2: Buyer's Responsibilities
The buyer must:
- Verify the VIN matches the title
- Complete the title transfer within the state's deadline (typically 10-30 days)
- Pay applicable taxes and fees
- Obtain new insurance
- Register the vehicle

### Step 3: DMV Processing
At the DMV, you'll need to:
- Submit the signed title
- Provide proof of insurance
- Pay title transfer fee ($15-$100 depending on state)
- Pay sales tax (varies by state)
- Complete any required inspections

## Required Documents

**For the Seller:**
- Original vehicle title
- Bill of sale
- Odometer disclosure statement
- Release of liability form

**For the Buyer:**
- Signed title from seller
- Valid driver's license or ID
- Proof of insurance
- Payment for fees and taxes

## State-Specific Requirements

Each state has unique requirements:

**California:** Requires smog certification for most vehicles
**Texas:** Requires vehicle inspection within 90 days
**Florida:** No vehicle inspection required
**New York:** Requires emissions testing in certain counties

## Common Title Transfer Mistakes

### Mistake 1: Incorrect Signatures
The title must be signed exactly as the name appears on the front. Any discrepancy can delay the transfer.

### Mistake 2: Missing Odometer Reading
Federal law requires odometer disclosure for vehicles less than 10 years old.

### Mistake 3: Waiting Too Long
Most states impose penalties for late title transfers. Complete the process within your state's deadline.

### Mistake 4: Not Checking for Liens
Always verify there are no outstanding liens on the vehicle before purchasing.

## Special Situations

### Gifting a Vehicle
Many states offer reduced or waived fees for family transfers. You'll typically need:
- Signed title
- Gift affidavit or statement
- Proof of relationship

### Inheriting a Vehicle
Inheriting a vehicle requires additional documentation:
- Death certificate
- Will or probate documents
- Affidavit of heirship (if no will)

### Out-of-State Transfers
When buying from another state:
- Verify the title is valid
- Check if your state requires additional inspections
- Be prepared for higher fees

## Title Transfer Costs

Typical costs include:
- Title transfer fee: $15-$100
- Sales tax: 2-8% of vehicle value
- Registration fee: $20-$200
- Inspection fee: $0-$50

**Total estimate:** $100-$500 depending on state and vehicle value

## After the Transfer

Once complete, you'll receive:
- New title in your name (2-6 weeks)
- Registration documents
- License plates (if applicable)

Keep all documents in a safe place and make copies for your records.

## Get Personalized Help

Every state has different requirements and timelines. Use our interactive tool to generate a customized checklist for your specific title transfer situation.
    `,
  },
  {
    slug: "vin-inspection-requirements",
    title: "VIN Inspection Requirements: What You Need to Know",
    date: "2024-01-05",
    readTime: "5 min",
    category: "Inspections",
    summary:
      "Understand when VIN inspections are required, where to get them done, and how to prepare for a smooth inspection process.",
    author: "Naz Diam",
    featured: false,
    tags: ["VIN Inspection", "Vehicle Inspection", "DMV Requirements"],
    content: `
A Vehicle Identification Number (VIN) inspection is a verification process to confirm that your vehicle's VIN matches official records. Here's everything you need to know.

## What Is a VIN Inspection?

A VIN inspection is a physical verification of your vehicle's identification number. An authorized inspector compares the VIN on your vehicle to the VIN on your title and registration documents.

## When Is It Required?

VIN inspections are typically required when:
- Registering an out-of-state vehicle
- Registering a newly purchased used vehicle
- Replacing a lost title
- Registering a rebuilt or salvage vehicle
- First-time registration in some states

## Who Can Perform VIN Inspections?

Authorized inspectors include:
- DMV employees
- Law enforcement officers
- Licensed vehicle inspection stations
- AAA offices (in some states)
- Certified mechanics (state-dependent)

## The Inspection Process

### What to Bring
- Vehicle title or registration
- Valid driver's license or ID
- Proof of insurance
- VIN inspection form (if provided by DMV)

### What They Check
The inspector will:
1. Locate the VIN on your vehicle (usually on dashboard near windshield)
2. Verify it matches your documents
3. Check for signs of tampering
4. Inspect secondary VIN locations (door jamb, engine block)
5. Complete the inspection form

### How Long It Takes
Most VIN inspections take 10-15 minutes.

## Where to Get Inspected

### DMV Office
**Pros:**
- Free in most states
- Official documentation
- No appointment needed (usually)

**Cons:**
- Long wait times
- Limited hours
- May require multiple visits

### Police Station
**Pros:**
- Often free
- Quick process
- Convenient locations

**Cons:**
- May require appointment
- Not available in all jurisdictions
- Limited hours

### Private Inspection Station
**Pros:**
- Flexible hours
- Quick service
- Often combined with other inspections

**Cons:**
- May charge fee ($10-$50)
- Must be state-certified
- Availability varies

## State-Specific Requirements

### California
- Required for all out-of-state vehicles
- Can be done at DMV or by CHP
- Free at DMV, may charge at CHP

### Texas
- Required for out-of-state vehicles
- Part of standard vehicle inspection
- Costs $7-$25

### Florida
- Required for out-of-state vehicles
- Can be done at DMV or by law enforcement
- Free service

### New York
- Required for out-of-state vehicles
- Must be done by DMV or police
- Free at DMV

## Common Issues and Solutions

### Issue 1: VIN Doesn't Match
If the VIN on your vehicle doesn't match your documents:
- Contact the seller immediately
- Do not complete the purchase
- Report to authorities if fraud is suspected

### Issue 2: VIN Is Damaged or Illegible
If your VIN is damaged:
- Contact your state DMV for guidance
- May require additional documentation
- Could need special inspection

### Issue 3: Multiple VIN Locations
Modern vehicles have VINs in multiple locations:
- Dashboard (visible through windshield)
- Driver's door jamb
- Engine block
- Frame rail

All should match. If they don't, further investigation is needed.

## Preparing for Your Inspection

**Before You Go:**
1. Clean the VIN area (dashboard and door jamb)
2. Gather all required documents
3. Verify your appointment (if required)
4. Check inspector's credentials

**During Inspection:**
1. Be present with the vehicle
2. Have documents ready
3. Answer questions honestly
4. Get copies of completed forms

## After the Inspection

Once your VIN inspection is complete:
- Keep the inspection certificate with your documents
- Submit it to DMV with your registration application
- Most certificates are valid for 30-90 days

## Cost Breakdown

| Location | Typical Cost |
|----------|--------------|
| DMV Office | Free |
| Police Station | Free |
| AAA Office | Free-$15 |
| Private Inspector | $10-$50 |

## Important Tips

**Tip 1:** Schedule your VIN inspection early in the registration process. Don't wait until the last minute.

**Tip 2:** Make copies of the completed inspection form for your records.

**Tip 3:** If moving states, get the inspection done before your temporary registration expires.

## Get Your Complete Checklist

VIN inspection is just one step in the vehicle registration process. Use our tool to get a complete, personalized checklist for your specific situation, including all required inspections and documents.
    `,
  },
]

// Try to import filesystem utilities, fall back to in-memory if not available
let fsUtils: typeof import("./blog-utils") | null = null
try {
  fsUtils = require("./blog-utils")
} catch (e) {
  console.log("[v0] Filesystem utilities not available, using in-memory blog data")
}

export async function getAllPosts(): Promise<BlogPost[]> {
  // Try filesystem first (production)
  if (fsUtils) {
    try {
      const posts = await fsUtils.getAllPosts()
      if (posts.length > 0) {
        return posts
      }
    } catch (e) {
      console.log("[v0] Filesystem read failed, using in-memory data")
    }
  }

  // Fall back to in-memory data (v0 preview)
  return blogPostsData.sort((a, b) => (a.date < b.date ? 1 : -1))
}

export async function getPostBySlug(slug: string): Promise<BlogPost | null> {
  // Try filesystem first (production)
  if (fsUtils) {
    try {
      const post = await fsUtils.getPostBySlug(slug)
      if (post) {
        return post
      }
    } catch (e) {
      console.log("[v0] Filesystem read failed, using in-memory data")
    }
  }

  // Fall back to in-memory data (v0 preview)
  return blogPostsData.find((post) => post.slug === slug) || null
}

export async function getFeaturedPosts(): Promise<BlogPost[]> {
  // Try filesystem first (production)
  if (fsUtils) {
    try {
      const posts = await fsUtils.getFeaturedPosts()
      if (posts.length > 0) {
        return posts
      }
    } catch (e) {
      console.log("[v0] Filesystem read failed, using in-memory data")
    }
  }

  // Fall back to in-memory data (v0 preview)
  return blogPostsData.filter((post) => post.featured)
}

export async function getPostsByCategory(category: string): Promise<BlogPost[]> {
  // Try filesystem first (production)
  if (fsUtils) {
    try {
      const posts = await fsUtils.getPostsByCategory(category)
      if (posts.length > 0) {
        return posts
      }
    } catch (e) {
      console.log("[v0] Filesystem read failed, using in-memory data")
    }
  }

  // Fall back to in-memory data (v0 preview)
  return blogPostsData.filter((post) => post.category === category)
}

export function getAllCategories(posts: BlogPost[]): string[] {
  const categories = new Set(posts.map((post) => post.category))
  return Array.from(categories).sort()
}

export function searchPosts(query: string, posts: BlogPost[]): BlogPost[] {
  const lowerQuery = query.toLowerCase()

  return posts.filter(
    (post) =>
      post.title.toLowerCase().includes(lowerQuery) ||
      post.summary.toLowerCase().includes(lowerQuery) ||
      post.category.toLowerCase().includes(lowerQuery) ||
      post.tags?.some((tag) => tag.toLowerCase().includes(lowerQuery)),
  )
}

export async function getRelatedPosts(currentSlug: string, category: string, limit = 3): Promise<BlogPost[]> {
  // Try filesystem first (production)
  if (fsUtils) {
    try {
      const posts = await fsUtils.getRelatedPosts(currentSlug, category, limit)
      if (posts.length > 0) {
        return posts
      }
    } catch (e) {
      console.log("[v0] Filesystem read failed, using in-memory data")
    }
  }

  // Fall back to in-memory data (v0 preview)
  return blogPostsData.filter((post) => post.slug !== currentSlug && post.category === category).slice(0, limit)
}
